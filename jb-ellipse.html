<link rel="import" href="/components/polymer/polymer.html" />
<link rel="import" href="/components/jb-3js/jb-3js-helper-color.html" />
<link rel="import" href="/components/jb-3js/jb-3js-helper-position.html" />

<dom-module id="jb-ellipse">
    <template>
        <content></content>
    </template>
</dom-module>

<script>
    Polymer({
        is: 'jb-ellipse',
        behaviors: [PositionBehavior, ColorBehavior],
        properties: {
        	name: {
        		type: String,
        		value: 'Ellipse'
        	},
        	semiMajorAxis: {
        		type: Number,
        		value: 1
        	},
			semiMinorAxis: {
				type: Number,
				value: 1
			}
        },
        observers: [
        	'propertiesChanged(semi-major-axis, semi-minor-axis)'
        ],
        created: function() {
       		var material = new THREE.LineBasicMaterial(this.color);

       		// Create the final Object3d to add to the scene
       		this.mesh = new THREE.Line(new THREE.Geometry(), material);
       		this._renewGeometry();
        },
        propertiesChanged: function(a, b) {
        	this.semiMajorAxis = a;
        	this.semiMinorAxis = b;
        	this._renewGeometry();
        },
        _renewGeometry: function() {
       		var curve = new THREE.EllipseCurve(
           		0, 0,             // ax, aY
          		this.semiMajorAxis, this.semiMinorAxis, // xRadius, yRadius
          		0,  2 * Math.PI,  // aStartAngle, aEndAngle
         		false,            // aClockwise
          		0                 // aRotation
          	);
          	var path = new THREE.Path(curve.getPoints(50));
          	this.mesh.geometry = path.createPointsGeometry(50);
        },
        ready: function() {
	        this.mesh.name = this.name;
	        this.mesh.material.color = new THREE.Color(this.color);
	        this._renewGeometry();
        },
        attached: function() {
            this.fire('add-to-scene', this.mesh);
        }
        
    });
</script>
